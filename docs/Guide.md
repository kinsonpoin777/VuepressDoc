# 接入指南

**接入流程：**

![Alt text](~@img/Qualification_application.png)

##	1. 产品接入指南
**术语描述：**

**PID:** Product ID，产品 ID。接入微瓴开放平台的每一款智能设备都有一个独立的 PID。

**SN:** Serial Number，每台设备都应该有一个唯一的序列号，序列号并不需要微瓴开放平台分配，所以您可以直接对接原有产品线的序 列号系统，但是我们对序列号格式有严格要求:长度必须是 4~64 个字符的字母、数字、下划线或者中划线的组合，例如 Q1GDU17C28006879 就是一个非常标准的序列号。

**License:** License 是对 SN 的数字签名，所以与 SN 是一一对应的，它存在的主要目的是保护合作方的利益，避免冒充合作方品牌的山 寨设备出现，License 的产生可以借助客户端工具实现。微瓴开放平台通过 PID+SN 唯一确定一台设备，并通过 License 来确认 SN 不 是随机伪造的，只有通过验证的 PID+SN+License，微瓴开放平台才会下发 DIN，拥有 DIN 的智能设备便可以直接接入微瓴开放平台。

**DIN:** 每台设备在平台上都会被分配一个唯一的DIN，是设备唯一的身份标识，通过这个DIN可以确定到单个设备。

**1.** 登录微瓴开放平台（https://open.welink.qq.com），点击开发中心： 

![Alt text](~@img/20190926191714.png)

**2.** 点击产品管理→新增产品： 

![Alt text](~@img/201909261917141.png)

**3.** 填写产品信息： 

![Alt text](~@img/201909261917142.png)

**4.** 提交之后可以在产品管理页看到刚申请的产品→点击调试：

![Alt text](~@img/2982844554c402a36a43d5419a70238.png)

**5.** 点击调试里面可以看到产品详细信息，PID已经生成，SN（设备准确的序列号）还需要手动输入，点击注册即可，到这里PID和SN申请完成。服务器公钥和设备私钥（签名私钥）请复制下来保管好，供后续接入流程加密解密使用。另外，子设备注册流程请查阅IOT通讯协议3.3网关上报子设备注册消息。 

![Alt text](~@img/0701eb54b76003c4c930d9728014fce.png)

**6.** 从开放平台获取到pid和sn之后，参照IOT通讯协议注册设备，接入微瓴。



##	2. 应用接入指南
**术语描述：**

**APP ID:** 应用唯一标识符。每创建一个新应用，后台会为其配置一个新的应用ID，且后续不可更改。创建过的应用即使在删除后，其应用ID仍然不能被新创建的应用所占有。

**APP Ticket:** 应用票据，在进行鉴权时会使用到，用于登录微瓴openAPI。票据均有有效期，在票据到期前需要替换。

**1.** 登录微瓴开放平台（https://open.welink.qq.com），点击开发中心： 

![Alt text](~@img/20190926191714.png)

**2.** 点击应用管理→新增应用：

![Alt text](~@img/cdb12351fa857248405c38e0682d3b3.png)

**3.** 填写应用信息提交：

应用名称: 仅支持中文、英文大小写、数字和常用符号，必须以中文、英文或数字开头。建议您在申请的时候以中文命名，最多输入 20 字符 , 且不可修改。

应用类型: web 应用、移动应用、PC 客户端。

应用领域: 包含智能建筑、智能家居、智慧社区、智慧园区、智慧城市、智慧零售及其他。

应用简介: 请详细描述该应用的主要功能和使用场景，以便我方工作人员进行检查和审核。最多输入 100 字符。

![Alt text](~@img/app2.png)

**4.** 回到应用管理→点击调试→填入回调地址点击保存→关联设备→提交

![Alt text](~@img/app3.png)

当应用申请提交后，微瓴开放平台会为您分配一个沙箱环境中的App ID 和App Ticket（如下图），需要注意的是，生产环境和沙箱环境会使用到不同的App ID和App Ticket，请注意区分。

其中App Ticket是有有效期限的，在沙箱阶段，默认有效期限是一年（一年按365天计算）。在距离到期时间前15天内，您可以根据自身需要对App Ticket进行重置，重置后会生成新的App Ticket，有效期限重新按照一年计算。

![Alt text](~@img/app6.png)

您需要填写消息回调地址，用于接收平台推送的消息和设备上报的数据。

温馨提示:消息回调地址必须以 https:// 开头，默认的端口号为 443，URL 长度不超过 100 个字符。

![Alt text](~@img/app4.png)

在应用调试过程中需要将应用与您的设备关联起来，若此时还未添加设备，您需要先添加设备。添加设备的时候需要您提交的信息包括：设备类型、设备名称、PID、SN、DIN。

![Alt text](~@img/app5.png)

→参照应用接口文档进行调试



