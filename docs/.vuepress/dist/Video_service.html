<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OPEN API Doc</title>
    <meta name="description" content="接口说明文档">
    <link rel="icon" href="/bitbug_favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.584498ef.css" as="style"><link rel="preload" href="/assets/js/app.db21f27a.js" as="script"><link rel="preload" href="/assets/js/2.82b08f5a.js" as="script"><link rel="preload" href="/assets/js/11.2b479cd9.js" as="script"><link rel="prefetch" href="/assets/js/10.22aa21c7.js"><link rel="prefetch" href="/assets/js/12.d0a30bd4.js"><link rel="prefetch" href="/assets/js/13.e1c32ab9.js"><link rel="prefetch" href="/assets/js/14.a358029f.js"><link rel="prefetch" href="/assets/js/15.b95dcb64.js"><link rel="prefetch" href="/assets/js/3.69a9e6aa.js"><link rel="prefetch" href="/assets/js/4.2a9a9e3e.js"><link rel="prefetch" href="/assets/js/5.ddaaa47b.js"><link rel="prefetch" href="/assets/js/6.898b7d41.js"><link rel="prefetch" href="/assets/js/7.04069a34.js"><link rel="prefetch" href="/assets/js/8.13be9294.js"><link rel="prefetch" href="/assets/js/9.4b85b1ac.js">
    <link rel="stylesheet" href="/assets/css/0.styles.584498ef.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">OPEN API Doc</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/Guide.html" class="sidebar-link">接入指南</a></li><li><a href="/IOT.html" class="sidebar-link">IOT通讯协议</a></li><li><a href="/Application_of_API.html" class="sidebar-link">应用API</a></li><li><a href="/Video_service.html" class="active sidebar-link">视频服务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Video_service.html#_1-获取视频设备扩展信息" class="sidebar-link">1 获取视频设备扩展信息</a></li><li class="sidebar-sub-header"><a href="/Video_service.html#_2-设置视频设备扩展信息" class="sidebar-link">2 设置视频设备扩展信息</a></li><li class="sidebar-sub-header"><a href="/Video_service.html#_3-获取本地录像" class="sidebar-link">3 获取本地录像</a></li><li class="sidebar-sub-header"><a href="/Video_service.html#_4-获取设备存储类型及天数" class="sidebar-link">4 获取设备存储类型及天数</a></li><li class="sidebar-sub-header"><a href="/Video_service.html#_5-查询设备某段时间确实录像片段" class="sidebar-link">5 查询设备某段时间确实录像片段</a></li><li class="sidebar-sub-header"><a href="/Video_service.html#_6-获取本地录像-硬件端" class="sidebar-link">6 获取本地录像-硬件端</a></li><li class="sidebar-sub-header"><a href="/Video_service.html#_7-查询sharp协议视频推流服务器信息" class="sidebar-link">7 查询SHARP协议视频推流服务器信息</a></li><li class="sidebar-sub-header"><a href="/Video_service.html#_8-sharp音视频流推送协议" class="sidebar-link">8 sharp音视频流推送协议</a></li><li class="sidebar-sub-header"><a href="/Video_service.html#_9-获取web流播放地址" class="sidebar-link">9 获取web流播放地址</a></li><li class="sidebar-sub-header"><a href="/Video_service.html#_10-获取hls流播放地址" class="sidebar-link">10 获取HLS流播放地址</a></li><li class="sidebar-sub-header"><a href="/Video_service.html#_11-查询录像列表" class="sidebar-link">11 查询录像列表</a></li><li class="sidebar-sub-header"><a href="/Video_service.html#_12-获取录像文件" class="sidebar-link">12 获取录像文件</a></li><li class="sidebar-sub-header"><a href="/Video_service.html#_13-录像保护" class="sidebar-link">13 录像保护</a></li><li class="sidebar-sub-header"><a href="/Video_service.html#_14-监控信息上报" class="sidebar-link">14 监控信息上报</a></li></ul></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数字空间</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/Error_code.html" class="sidebar-link">错误码</a></li><li><a href="/appendix.html" class="sidebar-link">附录</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>[TOC]</p> <h1 id="视频服务"><a href="#视频服务" aria-hidden="true" class="header-anchor">#</a> 视频服务</h1> <h2 id="_1-获取视频设备扩展信息"><a href="#_1-获取视频设备扩展信息" aria-hidden="true" class="header-anchor">#</a> 1 获取视频设备扩展信息</h2> <ul><li>请求url: <code>/common/video/getExtend</code></li> <li>请求方式: <code>get</code></li> <li>接口描述： 查询摄像机等音视频设备的扩展信息</li> <li>请求参数:</li></ul> <table><thead><tr><th style="text-align:center;">字段名称</th> <th style="text-align:center;">字段类型</th> <th style="text-align:center;">是否必须</th> <th style="text-align:center;">字段描述</th></tr></thead> <tbody><tr><td style="text-align:center;">token</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的动态密钥</td></tr> <tr><td style="text-align:center;">iotim_ticket</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的物联票据</td></tr> <tr><td style="text-align:center;">din</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">设备的唯一标识</td></tr> <tr><td style="text-align:center;">sub_id</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">子摄像头id</td></tr></tbody></table> <ul><li>请求示例：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code> /common/video/getExtend?
token=*******************************************************
&amp;din=******************
&amp;iotim_ticket=*******************************************************
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>返回参数：</li></ul> <table><thead><tr><th style="text-align:center;">返回参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">code</td> <td style="text-align:center;">String</td> <td style="text-align:center;">错误码，0表示成功，其他见错误码说明</td></tr> <tr><td style="text-align:center;">message</td> <td style="text-align:center;">String</td> <td style="text-align:center;">执行结果消息</td></tr> <tr><td style="text-align:center;">data</td> <td style="text-align:center;">JSON</td> <td style="text-align:center;">查询结果</td></tr> <tr><td style="text-align:center;">din</td> <td style="text-align:center;">String</td> <td style="text-align:center;">设备的唯一标识</td></tr> <tr><td style="text-align:center;">sub_vid</td> <td style="text-align:center;">String</td> <td style="text-align:center;">传统子摄像头id</td></tr> <tr><td style="text-align:center;">is_live</td> <td style="text-align:center;">Boolean</td> <td style="text-align:center;">是否直播</td></tr> <tr><td style="text-align:center;">is_recording</td> <td style="text-align:center;">Boolean</td> <td style="text-align:center;">是否录像</td></tr> <tr><td style="text-align:center;">is_face</td> <td style="text-align:center;">Boolean</td> <td style="text-align:center;">是否是人脸识别设备</td></tr> <tr><td style="text-align:center;">save_type</td> <td style="text-align:center;">String</td> <td style="text-align:center;">存储方式</td></tr> <tr><td style="text-align:center;">save_day</td> <td style="text-align:center;">Integer</td> <td style="text-align:center;">存储天数</td></tr> <tr><td style="text-align:center;">is_web_push</td> <td style="text-align:center;">Boolean</td> <td style="text-align:center;">是否网页推流</td></tr> <tr><td style="text-align:center;">web_resolution</td> <td style="text-align:center;">Integer</td> <td style="text-align:center;">网页推流分辨率，0：原画，360、720、1080 分别对应 360P、720P、1080P</td></tr> <tr><td style="text-align:center;">shell</td> <td style="text-align:center;">String</td> <td style="text-align:center;">摄像机外壳</td></tr> <tr><td style="text-align:center;">rom_version</td> <td style="text-align:center;">String</td> <td style="text-align:center;">摄像机固件版本</td></tr> <tr><td style="text-align:center;">sdk_version</td> <td style="text-align:center;">String</td> <td style="text-align:center;">摄像机SDK版本</td></tr> <tr><td style="text-align:center;">mac</td> <td style="text-align:center;">String</td> <td style="text-align:center;">摄像机mac地址</td></tr> <tr><td style="text-align:center;">code</td> <td style="text-align:center;">String</td> <td style="text-align:center;">摄像机编码</td></tr> <tr><td style="text-align:center;">password</td> <td style="text-align:center;">String</td> <td style="text-align:center;">摄像机登录密码</td></tr> <tr><td style="text-align:center;">lens</td> <td style="text-align:center;">String</td> <td style="text-align:center;">摄像机镜头</td></tr> <tr><td style="text-align:center;">c_id</td> <td style="text-align:center;">String</td> <td style="text-align:center;">摄像机云id</td></tr> <tr><td style="text-align:center;">record_data</td> <td style="text-align:center;">String</td> <td style="text-align:center;">摄像机录像规则</td></tr> <tr><td style="text-align:center;">advance_record</td> <td style="text-align:center;">Integer</td> <td style="text-align:center;">预录帧数，最大值 1000</td></tr> <tr><td style="text-align:center;">event_config</td> <td style="text-align:center;">JsonArray</td> <td style="text-align:center;">智能算法配置</td></tr></tbody></table> <ul><li>返回示例：</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;din&quot;</span><span class="token operator">:</span> <span class="token string">&quot;***************&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;is_live&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;is_recording&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;is_face&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;save_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hadoop1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;save_day&quot;</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
    <span class="token property">&quot;is_web_push&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;web_resolution&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;shell&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rom_version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sdk_version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mac&quot;</span><span class="token operator">:</span> <span class="token string">&quot;**：**：**：**：**：**&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lens&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4mm&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;c_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2427423&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;record_data&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;advance_record&quot;</span><span class="token operator">:</span> <span class="token number">60</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><hr> <h2 id="_2-设置视频设备扩展信息"><a href="#_2-设置视频设备扩展信息" aria-hidden="true" class="header-anchor">#</a> 2 设置视频设备扩展信息</h2> <ul><li>接口url： <code>/common/video/setExtend</code></li> <li>接口描述： <code>设置视频设配的扩展信息</code></li> <li>请求方法：<code>POST</code></li> <li>请求参数：</li></ul> <table><thead><tr><th style="text-align:center;">请求参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">是否必填</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">token</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的动态密钥</td></tr> <tr><td style="text-align:center;">iotim_ticket</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的物联票据</td></tr> <tr><td style="text-align:center;">din</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">设备的唯一标识</td></tr> <tr><td style="text-align:center;">sub_id</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">子摄像头id</td></tr> <tr><td style="text-align:center;">is_live</td> <td style="text-align:center;">Boolean</td> <td style="text-align:center;">是</td> <td style="text-align:center;">是否直播</td></tr> <tr><td style="text-align:center;">is_recording</td> <td style="text-align:center;">Boolean</td> <td style="text-align:center;">是</td> <td style="text-align:center;">是否录像</td></tr> <tr><td style="text-align:center;">is_face</td> <td style="text-align:center;">Boolean</td> <td style="text-align:center;">是</td> <td style="text-align:center;">是否是人脸识别设备</td></tr> <tr><td style="text-align:center;">save_type</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">存储方式</td></tr> <tr><td style="text-align:center;">save_day</td> <td style="text-align:center;">Integer</td> <td style="text-align:center;">是</td> <td style="text-align:center;">存储天数</td></tr> <tr><td style="text-align:center;">is_web_push</td> <td style="text-align:center;">Boolean</td> <td style="text-align:center;">是</td> <td style="text-align:center;">是否网页推流</td></tr> <tr><td style="text-align:center;">web_resolution</td> <td style="text-align:center;">Integer</td> <td style="text-align:center;">是</td> <td style="text-align:center;">网页推流分辨率，0：原画，360、720、1080 分别对应 360P、720P、1080P</td></tr> <tr><td style="text-align:center;">shell</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">摄像机外壳</td></tr> <tr><td style="text-align:center;">rom_version</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">摄像机固件版本</td></tr> <tr><td style="text-align:center;">sdk_version</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">摄像机SDK版本</td></tr> <tr><td style="text-align:center;">mac</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">摄像机mac地址</td></tr> <tr><td style="text-align:center;">code</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">摄像机编码</td></tr> <tr><td style="text-align:center;">password</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">摄像机登录密码</td></tr> <tr><td style="text-align:center;">lens</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">摄像机镜头</td></tr> <tr><td style="text-align:center;">c_id</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">摄像机云id</td></tr> <tr><td style="text-align:center;">record_data</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">摄像机录像规则</td></tr> <tr><td style="text-align:center;">advance_record</td> <td style="text-align:center;">Integer</td> <td style="text-align:center;">否</td> <td style="text-align:center;">预录帧数，最大值 1000</td></tr> <tr><td style="text-align:center;">event_config</td> <td style="text-align:center;">JsonArray</td> <td style="text-align:center;">否</td> <td style="text-align:center;">智能算法配置</td></tr></tbody></table> <ul><li>请求示例：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code> /common/video/setExtend?
token=*******************************************************
&amp;iotim_ticket=*******************************************************
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>a.请求头：Content-Type:application/json</li> <li>b.请求包体：</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;shell&quot;</span><span class="token operator">:</span><span class="token string">&quot;shell&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;recording&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;rom_version&quot;</span><span class="token operator">:</span><span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;face_recognition&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;sdk_version&quot;</span><span class="token operator">:</span><span class="token string">&quot;1.4.203&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;web_resolution&quot;</span><span class="token operator">:</span><span class="token number">360</span><span class="token punctuation">,</span><span class="token property">&quot;mac&quot;</span><span class="token operator">:</span><span class="token string">&quot;00:44:0f:9a:00:26&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;lens&quot;</span><span class="token operator">:</span><span class="token string">&quot;4mm&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;password&quot;</span><span class="token operator">:</span><span class="token string">&quot;1234&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;save_day&quot;</span><span class="token operator">:</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token property">&quot;din&quot;</span><span class="token operator">:</span><span class="token string">&quot;144115194519080010&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;save_type&quot;</span><span class="token operator">:</span><span class="token string">&quot;hadoop2&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;c_id&quot;</span><span class="token operator">:</span><span class="token string">&quot;2427423&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;record_data&quot;</span><span class="token operator">:</span><span class="token string">&quot;[{\&quot;record_cron\&quot;:\&quot;0 * * * * ?\&quot;, \&quot;record_long\&quot;:60},{\&quot;record_cron\&quot;:\&quot;0 * * * * ?\&quot;, \&quot;record_long\&quot;:240}]&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;live&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">&quot;web_push&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>返回参数：</li></ul> <table><thead><tr><th style="text-align:center;">返回参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">code</td> <td style="text-align:center;">String</td> <td style="text-align:center;">错误码，0表示成功，其他见错误码说明</td></tr> <tr><td style="text-align:center;">message</td> <td style="text-align:center;">String</td> <td style="text-align:center;">执行结果消息</td></tr></tbody></table> <ul><li>返回示例：</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_3-获取本地录像"><a href="#_3-获取本地录像" aria-hidden="true" class="header-anchor">#</a> 3 获取本地录像</h2> <ul><li><p>接口url： <code>/common/video/getLocalStream</code></p></li> <li><p>请求方法： <code>GET</code></p></li> <li><p>请求参数：</p> <table><thead><tr><th style="text-align:left;">请求参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:right;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:left;">*token</td> <td style="text-align:center;">String</td> <td style="text-align:right;">动态密码，登录时获得</td></tr> <tr><td style="text-align:left;">*iotim_ticket</td> <td style="text-align:center;">String</td> <td style="text-align:right;">QQ 物联票据</td></tr> <tr><td style="text-align:left;">*din</td> <td style="text-align:center;">String</td> <td style="text-align:right;">设备 din</td></tr> <tr><td style="text-align:left;">*stream_id</td> <td style="text-align:center;">String</td> <td style="text-align:right;">子码流id</td></tr> <tr><td style="text-align:left;">*timeBegin</td> <td style="text-align:center;">long</td> <td style="text-align:right;">开始时间</td></tr> <tr><td style="text-align:left;">*length</td> <td style="text-align:center;">long</td> <td style="text-align:right;">视频长度，秒，最长获取30s</td></tr> <tr><td style="text-align:left;">subDin</td> <td style="text-align:center;">String</td> <td style="text-align:right;">子摄像头影像流 id</td></tr></tbody></table></li> <li><p>请求示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/common/video/getLocalStream?
token=*************************
&amp;iotim_ticket=*************************
&amp;din=*************************
&amp;subDin=*************************
&amp;stream_id=*************************
&amp;timeBegin=*************************
&amp;length=*************************
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>返回参数：</p> <table><thead><tr><th>返回参数</th> <th style="text-align:left;">参数类型</th> <th style="text-align:left;">参数说明</th></tr></thead> <tbody><tr><td>code</td> <td style="text-align:left;">Integer</td> <td style="text-align:left;">错误码</td></tr> <tr><td>message</td> <td style="text-align:left;">String</td> <td style="text-align:left;">执行结果消息</td></tr> <tr><td>data</td> <td style="text-align:left;">json</td> <td style="text-align:left;">返回数据</td></tr> <tr><td>sm4_vector</td> <td style="text-align:left;">String</td> <td style="text-align:left;">加密向量</td></tr> <tr><td>recordHandler</td> <td style="text-align:left;">String</td> <td style="text-align:left;">本次录像的唯一标识</td></tr> <tr><td>timeBegin</td> <td style="text-align:left;">long</td> <td style="text-align:left;">开始时间，毫秒时间戳</td></tr> <tr><td>length</td> <td style="text-align:left;">long</td> <td style="text-align:left;">秒数，毫秒，最多获取30s的历史视频</td></tr> <tr><td>stream_token</td> <td style="text-align:left;">String</td> <td style="text-align:left;">流token</td></tr> <tr><td>stream_id</td> <td style="text-align:left;">String</td> <td style="text-align:left;">子码流</td></tr> <tr><td>stream_en_key</td> <td style="text-align:left;">String</td> <td style="text-align:left;">流加密key</td></tr> <tr><td>server_ip</td> <td style="text-align:left;">String</td> <td style="text-align:left;">外网地址</td></tr> <tr><td>server_port</td> <td style="text-align:left;">int</td> <td style="text-align:left;">服务器端口号</td></tr> <tr><td>cmd</td> <td style="text-align:left;">String</td> <td style="text-align:left;">命令字</td></tr> <tr><td>server_innerip</td> <td style="text-align:left;">String</td> <td style="text-align:left;">内网ip</td></tr></tbody></table></li> <li><p>返回示例：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;sm4_vector&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2019076905&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;recordHandler&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0108572e-4881-4644-a3b5-3e2c50286aeb&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timeBegin&quot;</span><span class="token operator">:</span> <span class="token number">2342432</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stream_token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;RKzwpUGM&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stream_id&quot;</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stream_en_key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;kO3Ahp6wkuLw6OfP&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;length&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token property">&quot;server_ip&quot;</span><span class="token operator">:</span> <span class="token string">&quot;61.241.44.161&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;server_port&quot;</span><span class="token operator">:</span> <span class="token number">31001</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cmd&quot;</span><span class="token operator">:</span> <span class="token string">&quot;LocalRecordStream&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;server_innerip&quot;</span><span class="token operator">:</span> <span class="token string">&quot;10.55.130.116&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OK&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li></ul> <h2 id="_4-获取设备存储类型及天数"><a href="#_4-获取设备存储类型及天数" aria-hidden="true" class="header-anchor">#</a> 4 获取设备存储类型及天数</h2> <ul><li><p>接口url： <code>/common/video/getDeviceSaveTypeAndDays</code></p></li> <li><p>请求方法： <code>GET</code></p></li> <li><p>请求参数：</p> <table><thead><tr><th style="text-align:left;">请求参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:right;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:left;">*token</td> <td style="text-align:center;">String</td> <td style="text-align:right;">动态密码，登录时获得</td></tr> <tr><td style="text-align:left;">*iotim_ticket</td> <td style="text-align:center;">String</td> <td style="text-align:right;">QQ 物联票据</td></tr> <tr><td style="text-align:left;">*din</td> <td style="text-align:center;">String</td> <td style="text-align:right;">设备 din</td></tr> <tr><td style="text-align:left;">sub_din</td> <td style="text-align:center;">String</td> <td style="text-align:right;">子摄像头影像流 id</td></tr></tbody></table></li> <li><p>请求示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/common/video/getDeviceSaveTypeAndDays?
token==*************************
&amp;iotim_ticket==*************************
&amp;din==*************************
&amp;sub_din==*************************
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>返回参数：</p> <table><thead><tr><th style="text-align:left;">返回参数</th> <th style="text-align:left;">参数类型</th> <th style="text-align:left;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:left;">code</td> <td style="text-align:left;">Integer</td> <td style="text-align:left;">错误码</td></tr> <tr><td style="text-align:left;">message</td> <td style="text-align:left;">String</td> <td style="text-align:left;">执行结果消息</td></tr> <tr><td style="text-align:left;">data</td> <td style="text-align:left;">json</td> <td style="text-align:left;">返回数据</td></tr> <tr><td style="text-align:left;">save_type</td> <td style="text-align:left;">String</td> <td style="text-align:left;">保存类型：cosmtav(云端)，nvr（本地）</td></tr> <tr><td style="text-align:left;">save_day</td> <td style="text-align:left;">int</td> <td style="text-align:left;">录像保存天数</td></tr> <tr><td style="text-align:left;">din</td> <td style="text-align:left;">String</td> <td style="text-align:left;">设备id</td></tr></tbody></table></li> <li><p>返回示例：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;save_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nvr&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;save_day&quot;</span><span class="token operator">:</span> <span class="token number">65</span><span class="token punctuation">,</span>
    <span class="token property">&quot;din&quot;</span><span class="token operator">:</span> <span class="token string">&quot;din&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OK&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul> <h2 id="_5-查询设备某段时间确实录像片段"><a href="#_5-查询设备某段时间确实录像片段" aria-hidden="true" class="header-anchor">#</a> 5 查询设备某段时间确实录像片段</h2> <ul><li><p>接口url： <code>/common/video/getVideoLostRecord</code></p></li> <li><p>请求方法： <code>GET</code></p></li> <li><p>请求参数：</p> <table><thead><tr><th>请求参数</th> <th style="text-align:left;">参数类型</th> <th style="text-align:left;">参数说明</th></tr></thead> <tbody><tr><td>*token</td> <td style="text-align:left;">String</td> <td style="text-align:left;">动态密码，登录时获得</td></tr> <tr><td>*iotim_ticket</td> <td style="text-align:left;">String</td> <td style="text-align:left;">QQ 物联票据</td></tr> <tr><td>*din</td> <td style="text-align:left;">String</td> <td style="text-align:left;">设备 din</td></tr> <tr><td>subDin</td> <td style="text-align:left;">String</td> <td style="text-align:left;">子摄像头影像流 id</td></tr> <tr><td>*start_time</td> <td style="text-align:left;">long</td> <td style="text-align:left;">开始时间，毫秒</td></tr> <tr><td>*end_time</td> <td style="text-align:left;">long</td> <td style="text-align:left;">结束时间，毫秒</td></tr></tbody></table></li> <li><p>请求示例：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/common/video/getVideoLostRecord?token=
&amp;iotim_ticket===*************************
&amp;din===*************************
&amp;subDin===*************************
&amp;start_time===*************************
&amp;end_time===*************************
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>返回参数：</p> <table><thead><tr><th style="text-align:left;">返回参数</th> <th style="text-align:left;">参数类型</th> <th style="text-align:left;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:left;">code</td> <td style="text-align:left;">Integer</td> <td style="text-align:left;">错误码</td></tr> <tr><td style="text-align:left;">message</td> <td style="text-align:left;">String</td> <td style="text-align:left;">执行结果消息</td></tr> <tr><td style="text-align:left;">data</td> <td style="text-align:left;">json</td> <td style="text-align:left;">返回数据</td></tr> <tr><td style="text-align:left;">handler</td> <td style="text-align:left;">String</td> <td style="text-align:left;">消息唯一id</td></tr></tbody></table></li> <li><p>返回示例：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;handler&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fdsafasfds&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul> <h2 id="_6-获取本地录像-硬件端"><a href="#_6-获取本地录像-硬件端" aria-hidden="true" class="header-anchor">#</a> 6 获取本地录像-硬件端</h2> <ul><li><p>datapoint:20229</p></li> <li><p>设备收到到参数：
{&quot;din&quot;:&quot;din&quot;,
&quot;sub_din&quot;:&quot;0&quot;,
&quot;handler&quot;:&quot;uuid&quot;,
&quot;start_time&quot;:324324324,
&quot;end_time&quot;:3243243243234
}</p></li> <li><p>设备针对seq返回消息格式：</p> <p>{
code: 0,
msg: &quot;success&quot;,
data: {
&quot;handler&quot;:&quot;收到值&quot;，
losts:[
{begin_time:XXXX,end_time:XXXX},
{begin_time:XXXX,end_time:XXXX}
]
}
}</p></li></ul> <h2 id="_7-查询sharp协议视频推流服务器信息"><a href="#_7-查询sharp协议视频推流服务器信息" aria-hidden="true" class="header-anchor">#</a> 7 查询SHARP协议视频推流服务器信息</h2> <ul><li>接口url： <code>/common/video/getStreamServer</code></li> <li>描述： <code>查询sharp协议视频推流服务器信息，低延时获取视频方式，1秒钟之内，需要自行开发播放器。</code></li> <li>请求方法： <code>GET</code></li> <li>请求参数：</li></ul> <table><thead><tr><th style="text-align:center;">请求参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">是否必填</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">token</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的动态密钥</td></tr> <tr><td style="text-align:center;">iotim_ticket</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的物联票据</td></tr> <tr><td style="text-align:center;">din</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">设备的唯一标识</td></tr> <tr><td style="text-align:center;">sub_id</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">子摄像头id</td></tr></tbody></table> <ul><li>请求示例：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code> /common/video/getStreamServer?
token=*******************************************************
&amp;din=***************
&amp;iotim_ticket=*******************************************************
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>返回参数：</li></ul> <table><thead><tr><th style="text-align:center;">返回参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">code</td> <td style="text-align:center;">String</td> <td style="text-align:center;">错误码，0表示成功，其他见错误码说明</td></tr> <tr><td style="text-align:center;">message</td> <td style="text-align:center;">String</td> <td style="text-align:center;">执行结果消息</td></tr> <tr><td style="text-align:center;">data</td> <td style="text-align:center;">Json</td> <td style="text-align:center;">查询结果</td></tr> <tr><td style="text-align:center;">ip</td> <td style="text-align:center;">String</td> <td style="text-align:center;">推流服务器IP</td></tr> <tr><td style="text-align:center;">innerip</td> <td style="text-align:center;">String</td> <td style="text-align:center;">推流服务器内网IP</td></tr> <tr><td style="text-align:center;">stream_token</td> <td style="text-align:center;">String</td> <td style="text-align:center;">Sharp协议握手token</td></tr> <tr><td style="text-align:center;">port</td> <td style="text-align:center;">Integer</td> <td style="text-align:center;">sharp 服务端口号，如果无该返回值端口号默认为30001</td></tr> <tr><td style="text-align:center;">stream_en_key</td> <td style="text-align:center;">String</td> <td style="text-align:center;">视频流加密key,目前为AES128加密KEY，如无该值说明当前环境暂时不支持加密</td></tr></tbody></table> <ul><li>返回示例：</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;ip&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;innerip&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stream_token&quot;</span><span class="token operator">:</span><span class="token string">&quot;2C9A8F42&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token number">30001</span><span class="token punctuation">,</span>
    <span class="token property">&quot;stream_en_key&quot;</span><span class="token operator">:</span><span class="token string">&quot;AES128AES128AES1&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_8-sharp音视频流推送协议"><a href="#_8-sharp音视频流推送协议" aria-hidden="true" class="header-anchor">#</a> 8 sharp音视频流推送协议</h2> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>•  通讯协议：TCP
•  IP：通过平台接口获取
•  端口：port或30001
•  流程 1.腾讯微瓴-&gt; 业务第三方 (握手)； 2.如果 1 握手成功后面就正常推数据块流，遇到音视频结束 type，推送结束； 3.字节序（大端）
•  握手
------------------------------------------------------------------
|  0   |  1   |  2   |   3   |   4   |   5   |   6   |     7     |
------------------------------------------------------------------
| 0x7f | 0x7f | 0x7f |   V   |        sub_vid        | stream_id |
------------------------------------------------------------------
|                         Device din                             |
------------------------------------------------------------------
|                        stream_token                            |
------------------------------------------------------------------
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>说明：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>•  0~2 字节固定为 0x7f
•  第 3 字节为版本号，当前为 3，对于新部署环境只支持版本3
•  第 4~6 字节为子视频流 ID，非网关设备比字段填 0
•  第 7 字节为码流 ID，0 为主码流。（当前版本仅支持主码流）
•  8~15 字节为所请求视频的摄像头 din。
•  16~23 字节为 stream_token。
•  响应包
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-text"><code>---------------------------------------------------------------------
|    0  --  7    |    8  --  15   |    16 -- 23    |    24 -- 31    |
---------------------------------------------------------------------
|                              length                               |
---------------------------------------------------------------------
|     result     |       Ver      |   A   |   V    |        E       |
---------------------------------------------------------------------
|                      start timestamp high                         |
---------------------------------------------------------------------
|                      start timestamp low                          |
---------------------------------------------------------------------
|                            error info                             |
---------------------------------------------------------------------
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li>说明：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>•  length：握手响应包数据总长度(4 字节)
•  result: 响应码（1 字节，非 0 表示失败 if result =0 then errorinfo length=0)
•  Ver: 版本号（1 字节 当前版本：1)
•  A: 音频数据包编码( 4bit 1: AMR 2: AAC 6:G711）
•  V：视频数据包编码( 4bit 1: H.264 2: H.265）
•  E：加密方式(1 字节 0:表示不加密 1: AES-128(AES-128为版本3所使用的加密算法) 2: AES-256 (其中加密key为查询视频推流服务器时返回的stream_en_key值)
•  start timestamp: 视频起始时间戳（8 字节）
•  error info ：失败错误提示字符串(length - 16 字节),result 为 0 时无此节。
•  数据块
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-text"><code>---------------------------------------------------------------------
|    0  --  7    |    8  --  15   |    16 -- 23    |    24 -- 31    |
---------------------------------------------------------------------
|                      length                      |  type  | frame |
---------------------------------------------------------------------
|         encryptedLength         | 保留                            |
---------------------------------------------------------------------
|                             timestamp                             |
---------------------------------------------------------------------
|                          sequence number                          |
---------------------------------------------------------------------
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-text"><code>•  length：每一帧视频数据和包头总长（长度由前 3 个字节表示)
•  type：(4 bit 1：视频 2: 音频 0xF：结束帧，表示音视频结束，连接可以断开）
•  frame: 帧类型 (4bit：1:表示是关键 I 帧)
•  encryptedLength: 加密数据字节长度(16bit：0表示该帧无加密数据，即为原始数据；如果加密数据长度大于零时，密钥为获取服务器IP地址时返回的stream_en_key,还原原始帧数据方法为：加密数据解密后的数据，加上除去加密数据后的数据，如：收到帧数据为data[encryptedLength]+data[length-16- encryptedLength] 则解密后的数据为：decrypt（data[encryptedLength]）+ data[length-16- encryptedLength])
•  timestamp：时间戳(4 字节) – 这里指的是偏移量
•  sequence number: 序列号(4 字节），后跟视频裸帧数据，长度为：length-16
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><hr> <h2 id="_9-获取web流播放地址"><a href="#_9-获取web流播放地址" aria-hidden="true" class="header-anchor">#</a> 9 获取web流播放地址</h2> <ul><li>接口url： <code>/common/video/getWebUrl</code></li> <li>描述： <code>查询web流的播放地址。HLS高延时方案，10至20秒，Web端播放， RTMP需要支持flash播放器的组件端播放</code></li> <li>请求方法：<code>GET</code></li> <li>请求参数：</li></ul> <table><thead><tr><th style="text-align:center;">请求参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">是否必填</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">token</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的动态密钥</td></tr> <tr><td style="text-align:center;">iotim_ticket</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的物联票据</td></tr> <tr><td style="text-align:center;">din</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">设备的唯一标识</td></tr> <tr><td style="text-align:center;">sub_id</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">子摄像头id</td></tr></tbody></table> <ul><li>请求示例：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code> /common/video/getWebUrl?
token=*******************************************************
&amp;din=***************
&amp;iotim_ticket=*******************************************************
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>返回参数：</li></ul> <table><thead><tr><th style="text-align:center;">返回参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">code</td> <td style="text-align:center;">String</td> <td style="text-align:center;">错误码，0表示成功，其他见错误码说明</td></tr> <tr><td style="text-align:center;">message</td> <td style="text-align:center;">String</td> <td style="text-align:center;">执行结果消息</td></tr> <tr><td style="text-align:center;">data</td> <td style="text-align:center;">JSON</td> <td style="text-align:center;">查询结果</td></tr> <tr><td style="text-align:center;">rtmp</td> <td style="text-align:center;">String</td> <td style="text-align:center;">rtmp推流地址,一次有效，断开后重新获取</td></tr> <tr><td style="text-align:center;">url</td> <td style="text-align:center;">String</td> <td style="text-align:center;">hls推流地址，两小时之类有效，过期后重新获取</td></tr></tbody></table> <ul><li>返回示例：</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;rtmp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rtmp:// 10.33.22.44:1999/vx134?ticket=7d840b8760754a6c9cbd27fe9f93bc28&quot;</span>
    <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https:// api-c.weiling.qq.com/sandbox /hls/144115192371634088.m3u8?ticket=7d840b8760754a6c9cbd27fe9f93bc28&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_10-获取hls流播放地址"><a href="#_10-获取hls流播放地址" aria-hidden="true" class="header-anchor">#</a> 10 获取HLS流播放地址</h2> <ul><li>接口url： <code>/common/video/getPlayUrl</code></li> <li>描述： <code>查询HLS流的播放地址。高延时方案，10至20秒，Web端播放</code></li> <li>请求方法：<code>GET</code></li> <li>请求参数：</li></ul> <table><thead><tr><th style="text-align:center;">请求参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">是否必填</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">token</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的动态密钥</td></tr> <tr><td style="text-align:center;">iotim_ticket</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的物联票据</td></tr> <tr><td style="text-align:center;">din</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">设备的唯一标识</td></tr> <tr><td style="text-align:center;">sub_id</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">子摄像头id</td></tr></tbody></table> <ul><li>请求示例：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code> /common/video/getPlayUrl?
token=*******************************************************
&amp;din=***************
&amp;iotim_ticket=*******************************************************
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>返回参数：</li></ul> <table><thead><tr><th style="text-align:center;">返回参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">code</td> <td style="text-align:center;">String</td> <td style="text-align:center;">错误码，0表示成功，其他见错误码说明</td></tr> <tr><td style="text-align:center;">message</td> <td style="text-align:center;">String</td> <td style="text-align:center;">执行结果消息</td></tr> <tr><td style="text-align:center;">data</td> <td style="text-align:center;">JSON</td> <td style="text-align:center;">查询结果</td></tr> <tr><td style="text-align:center;">url</td> <td style="text-align:center;">String</td> <td style="text-align:center;">Web推流地址</td></tr></tbody></table> <ul><li>返回示例：</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https:// api-c.weiling.qq.com/sandbox /hls/144115192371634088.m3u8?ticket=7d840b8760754a6c9cbd27fe9f93bc28&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_11-查询录像列表"><a href="#_11-查询录像列表" aria-hidden="true" class="header-anchor">#</a> 11 查询录像列表</h2> <ul><li>接口url： <code>/common/video/getVideoList</code></li> <li>描述： <code>根据条件查询录像信息，可以跟据月来查询当前月有录像的日期，也可以根据日期和起始以及终止时间来查询录像信息。两种查询条件不能同时为空。</code></li> <li>请求方法：<code>GET</code></li> <li>请求参数：</li></ul> <table><thead><tr><th style="text-align:center;">请求参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">是否必填</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">token</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的动态密钥</td></tr> <tr><td style="text-align:center;">iotim_ticket</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的物联票据</td></tr> <tr><td style="text-align:center;">din</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">设备的唯一标识</td></tr> <tr><td style="text-align:center;">sub_id</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">子摄像头id</td></tr> <tr><td style="text-align:center;">month</td> <td style="text-align:center;">String</td> <td style="text-align:center;">按月查询必填</td> <td style="text-align:center;">年月（YYYYMM格式）</td></tr> <tr><td style="text-align:center;">date</td> <td style="text-align:center;">String</td> <td style="text-align:center;">日期查询必填</td> <td style="text-align:center;">日期（YYYYMMDD格式）</td></tr> <tr><td style="text-align:center;">start</td> <td style="text-align:center;">String</td> <td style="text-align:center;">日期查询必填</td> <td style="text-align:center;">开始时间（HHmmss格式）</td></tr> <tr><td style="text-align:center;">end</td> <td style="text-align:center;">String</td> <td style="text-align:center;">日期查询必填</td> <td style="text-align:center;">结束时间（HHmmss格式）</td></tr></tbody></table> <ul><li>请求示例：</li> <li>a.请求示例1：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>/common/video/getVideoList?
token=*******************************************************
&amp;din=***************
&amp;month=201705
&amp;iotim_ticket=*******************************************************
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>b.请求示例2：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>/common/video/getVideoList?
token=*******************************************************
&amp;din=***************
&amp;date=20170510
&amp;start=122200
&amp;end=122500
&amp;iotim_ticket=****************************************************
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>返回参数：</li></ul> <table><thead><tr><th style="text-align:center;">返回参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">rec_date</td> <td style="text-align:center;">String</td> <td style="text-align:center;">日期</td></tr> <tr><td style="text-align:center;">rec_count</td> <td style="text-align:center;">Integer</td> <td style="text-align:center;">有无录像，0：无录像，1：有录像</td></tr> <tr><td style="text-align:center;">[]</td> <td style="text-align:center;">String</td> <td style="text-align:center;">文件名</td></tr> <tr><td style="text-align:center;">s</td> <td style="text-align:center;">String</td> <td style="text-align:center;">起始时间</td></tr> <tr><td style="text-align:center;">d</td> <td style="text-align:center;">Integer</td> <td style="text-align:center;">录像文件时长，单位：毫秒</td></tr> <tr><td style="text-align:center;">t</td> <td style="text-align:center;">Integer</td> <td style="text-align:center;">文件属性(从低位到高位, 第 0 位表示定时录像; 第 1 位表示手动录像; 第 2 位表示移动侦测录像; 第 3 位表示输入报警; 后面定义的类型以此类推. 0 表示否, 1 表示是)</td></tr> <tr><td style="text-align:center;">p</td> <td style="text-align:center;">String</td> <td style="text-align:center;">文件存储路径</td></tr></tbody></table> <ul><li>返回示例：</li> <li>a.返回示例1：</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;rec_date&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2017-05-01&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rec_count&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;rec_date&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2017-05-02&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rec_count&quot;</span><span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li>.返回示例2：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>[144115194519265640_20170510_122205.mtav]
 s=12:22:05.853
 d=8007
 t=10000000
 p=hdfs://192.168.1.1:8020/bucket/144115194519265640/2017-05-10/144115194519265640_20170510_122205.mtav
 [144115194519265640_20170510_122213.mtav]
 s=12:22:13.862
 d=7999
 t=10000000
 p=hdfs://192.168.1.1:8020/bucket/144115194519265640/2017-05-10/144115194519265640_20170510_122213.mtav
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_12-获取录像文件"><a href="#_12-获取录像文件" aria-hidden="true" class="header-anchor">#</a> 12 获取录像文件</h2> <ul><li>接口url： <code>/common/video/getVideoStream</code></li> <li>描述： <code>获取录像文件，返回文件流。</code></li> <li>请求方法：<code>GET</code></li> <li>请求参数：</li></ul> <table><thead><tr><th style="text-align:center;">请求参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">是否必填</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">token</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的动态密钥</td></tr> <tr><td style="text-align:center;">iotim_ticket</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的物联票据</td></tr> <tr><td style="text-align:center;">din</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">设备的唯一标识</td></tr> <tr><td style="text-align:center;">id</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">录像列表中返回的参数</td></tr> <tr><td style="text-align:center;">sub_id</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">子摄像头id</td></tr></tbody></table> <ul><li>请求示例：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code> /common/video/getVideoStream?
token=*******************************************************
&amp;din=***************
&amp;id=hdfs://192.168.1.1:8020/bucket/144115194519265640/2017-05-10/144115194519265640_20170510_122205.mtav
&amp;iotim_ticket=*******************************************************
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>返回参数：</li></ul> <table><thead><tr><th style="text-align:center;">返回参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">fileStream</td> <td style="text-align:center;">fileStream</td> <td style="text-align:center;">录像文件流</td></tr></tbody></table> <ul><li>返回示例：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>Content-Type：application/octet-stream
  fileStream……
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_13-录像保护"><a href="#_13-录像保护" aria-hidden="true" class="header-anchor">#</a> 13 录像保护</h2> <ul><li>接口url： <code>/common/video/setRecordLife</code></li> <li>描述：<code>用于设置录像的生命周期，设置录像的开始时间、结束时间以及录像删除的时间。单次设置保护的时长最大为 24 小时，start 和 end 的时差超过 24 小时会返回错误。life_time 和当前时间差不能小于一小时。避免误操作导致录像被立即删除。比如当前是北京时间 2017-7-29 12:00:00，那么设置的 life_time 只能大于 2017-7-29 13:00:00</code></li> <li>请求方法：<code>GET</code></li> <li>请求参数：</li></ul> <table><thead><tr><th style="text-align:center;">请求参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">是否必填</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">token</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的动态密钥</td></tr> <tr><td style="text-align:center;">iotim_ticket</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">鉴权参数：登录获取的物联票据</td></tr> <tr><td style="text-align:center;">din</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">设备的唯一标识</td></tr> <tr><td style="text-align:center;">start</td> <td style="text-align:center;">Long</td> <td style="text-align:center;">是</td> <td style="text-align:center;">开始时间，时间戳，单位：毫秒</td></tr> <tr><td style="text-align:center;">end</td> <td style="text-align:center;">Long</td> <td style="text-align:center;">是</td> <td style="text-align:center;">结束时间，时间戳，单位：毫秒</td></tr> <tr><td style="text-align:center;">life_time</td> <td style="text-align:center;">Long</td> <td style="text-align:center;">是</td> <td style="text-align:center;">录像删除的时间，时间戳，单位：毫秒</td></tr> <tr><td style="text-align:center;">sub_id</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">子摄像头id</td></tr></tbody></table> <ul><li>请求示例：</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>/common/video/setRecordLife?
token=*******************************************************
&amp;din=******************
&amp;start=1501120800000
&amp;end=1501128000000
&amp;left_time=1532664000000
&amp;iotim_ticket=*******************************************************
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>返回参数：</li></ul> <table><thead><tr><th style="text-align:center;">返回参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">code</td> <td style="text-align:center;">String</td> <td style="text-align:center;">错误码，0表示成功，其他见错误码说明</td></tr> <tr><td style="text-align:center;">message</td> <td style="text-align:center;">String</td> <td style="text-align:center;">执行结果消息</td></tr> <tr><td style="text-align:center;">data</td> <td style="text-align:center;">Json</td> <td style="text-align:center;">操作结果</td></tr> <tr><td style="text-align:center;">update_num</td> <td style="text-align:center;">Integer</td> <td style="text-align:center;">录像记录修改数量</td></tr></tbody></table> <ul><li>返回示例：</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
      <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
         <span class="token property">&quot;update_num&quot;</span><span class="token operator">:</span> <span class="token number">1000</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="_14-监控信息上报"><a href="#_14-监控信息上报" aria-hidden="true" class="header-anchor">#</a> 14 监控信息上报</h2> <ul><li>接口url:  <code>/monitor/addMonitor</code></li> <li>描述： <code>用于上报监控时间，例如上报应用或者设备心跳信息</code></li> <li>请求方法：<code>GET,POST</code></li> <li>请求参数：</li></ul> <table><thead><tr><th style="text-align:center;">请求参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">是否必填</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">monitorType</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">监控类型：API_MONITOR，VIDEO_PUSH, RPC_MONITOR, WEILINK_API, WEB_API,APP_DATA_MONITOR</td></tr> <tr><td style="text-align:center;">monitorTime</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">监控时间点</td></tr> <tr><td style="text-align:center;">serviceName</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">服务名称</td></tr> <tr><td style="text-align:center;">accessTime</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">访问时间</td></tr> <tr><td style="text-align:center;">result</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">监控对象访问结果</td></tr> <tr><td style="text-align:center;">fromIp</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">监控对象调用来源</td></tr> <tr><td style="text-align:center;">projectId</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">项目ID</td></tr> <tr><td style="text-align:center;">appId</td> <td style="text-align:center;">String</td> <td style="text-align:center;">是</td> <td style="text-align:center;">应用ID</td></tr> <tr><td style="text-align:center;">useTime</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否</td> <td style="text-align:center;">监控对象调用耗时，单位ms</td></tr> <tr><td style="text-align:center;">targetIp</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否  监控对象执行ip</td> <td style="text-align:center;"></td></tr> <tr><td style="text-align:center;">din</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否  设备din</td> <td style="text-align:center;"></td></tr> <tr><td style="text-align:center;">reportIp</td> <td style="text-align:center;">String</td> <td style="text-align:center;">否  上报监控的ip</td> <td style="text-align:center;"></td></tr></tbody></table> <ul><li>请求示例：</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">&quot;accessTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;201902121335&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;appId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;din&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;fromIp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;monitorTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;201902121335&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;monitorType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;API_MONITOR&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;projectId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;reportIp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;serviceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;addMonitor&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;targetIp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;useTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;122&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ul><li>返回参数：</li></ul> <table><thead><tr><th style="text-align:center;">返回参数</th> <th style="text-align:center;">参数类型</th> <th style="text-align:center;">参数说明</th></tr></thead> <tbody><tr><td style="text-align:center;">code</td> <td style="text-align:center;">String</td> <td style="text-align:center;">错误码，0表示成功，其他见错误码说明</td></tr> <tr><td style="text-align:center;">message</td> <td style="text-align:center;">String</td> <td style="text-align:center;">执行结果消息</td></tr> <tr><td style="text-align:center;">data</td> <td style="text-align:center;">Json</td> <td style="text-align:center;">参数值列表</td></tr> <tr><td style="text-align:center;">update_num</td> <td style="text-align:center;">Integer</td> <td style="text-align:center;">录像记录修改数量</td></tr></tbody></table> <ul><li>返回示例：</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;accessTime&quot;</span><span class="token operator">:</span> <span class="token number">121212121</span><span class="token punctuation">,</span>
      <span class="token property">&quot;appId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;din&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;fromIp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;monitorTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;201902121335&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;monitorType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;API_MONITOR&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;projectId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;reportIp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;10.56.63.17&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;sequence&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e04869f2-cb09-4ef2-9b99-c25e4cd04139&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;serviceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;addMonitor&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;targetIp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;useTime&quot;</span><span class="token operator">:</span> <span class="token number">122</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OK&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Application_of_API.html" class="prev">应用API</a></span> <span class="next"><a href="/data_space/Basic_document.html">数字空间基础能力接口文档</a>→
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.db21f27a.js" defer></script><script src="/assets/js/2.82b08f5a.js" defer></script><script src="/assets/js/11.2b479cd9.js" defer></script>
  </body>
</html>
